<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="io.github.lishangbu.avalon.dataset.mapper.TypeDamageRelationMapper">
  <!-- 通用查询映射结果 -->
  <resultMap id="BaseResultMap" type="io.github.lishangbu.avalon.dataset.entity.TypeDamageRelation">
    <id column="attacking_type_id" property="attackingTypeId"/>
    <id column="defending_type_id" property="defendingTypeId"/>
    <result column="multiplier" property="multiplier"/>
  </resultMap>

  <!-- 插入属性克制关系 -->
  <insert id="insert" parameterType="io.github.lishangbu.avalon.dataset.entity.TypeDamageRelation">
    INSERT INTO type_damage_relation
    <trim prefix="(" suffix=")" suffixOverrides=",">
      <if test="attackingTypeId != null">
        attacking_type_id,
      </if>
      <if test="defendingTypeId != null">
        defending_type_id,
      </if>
      <if test="multiplier != null">
        multiplier,
      </if>
    </trim>
    <trim prefix="VALUES (" suffix=")" suffixOverrides=",">
      <if test="attackingTypeId != null">
        #{attackingTypeId},
      </if>
      <if test="defendingTypeId != null">
        #{defendingTypeId},
      </if>
      <if test="multiplier != null">
        #{multiplier},
      </if>
    </trim>
  </insert>

  <!-- 根据复合主键更新属性克制关系 -->
  <update id="update" parameterType="io.github.lishangbu.avalon.dataset.entity.TypeDamageRelation">
    UPDATE type_damage_relation
    SET multiplier = #{multiplier}
    WHERE attacking_type_id = #{attackingTypeId}
      AND defending_type_id = #{defendingTypeId}
  </update>

  <!-- 根据复合主键删除属性克制关系 -->
  <delete id="deleteByAttackingTypeIdAndDefendingTypeId">
    DELETE
    FROM type_damage_relation
    WHERE attacking_type_id = #{attackingTypeId}
      AND defending_type_id = #{defendingTypeId}
  </delete>

  <!-- 分页查询属性克制关系列表（支持动态条件） -->
  <select id="selectList" resultMap="BaseResultMap" parameterType="map">
    SELECT attacking_type_id,defending_type_id,multiplier
    FROM type_damage_relation
    <where>
      <if test="typeDamageRelation.attackingTypeId != null">
        AND attacking_type_id = #{typeDamageRelation.attackingTypeId}
      </if>
      <if test="typeDamageRelation.defendingTypeId != null">
        AND defending_type_id = #{typeDamageRelation.defendingTypeId}
      </if>
      <if test="typeDamageRelation.multiplier != null">
        AND multiplier = #{typeDamageRelation.multiplier}
      </if>
    </where>
    ORDER BY attacking_type_id ASC, defending_type_id ASC
  </select>

  <!-- 根据复合主键查询属性克制关系 -->
  <select id="selectByAttackingTypeIdAndDefendingTypeId" resultMap="BaseResultMap">
    SELECT attacking_type_id, defending_type_id, multiplier
    FROM type_damage_relation
    WHERE attacking_type_id = #{attackingTypeId}
      AND defending_type_id = #{defendingTypeId}
  </select>
</mapper>
